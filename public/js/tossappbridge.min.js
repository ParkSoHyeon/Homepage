!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("toss-app-bridge",[],t):"object"==typeof exports?exports["toss-app-bridge"]=t():e["toss-app-bridge"]=t()}(this,function(){return function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();e.exports=function(){function e(t){n(this,e),this.context=t||{appVersion:"1.0.0",debug:!0}}return r(e,[{key:"checkApiSupport",value:function(e){return!0}},{key:"trackEvent",value:function(e){console.log("trackEvent => "+JSON.stringify(e))}},{key:"trackScreen",value:function(e){console.log("screenName => "+e)}},{key:"trackState",value:function(e){console.log("trackState => "+JSON.stringify(e))}},{key:"closeWebView",value:function(){console.log("closeWebView invoked")}},{key:"share",value:function(e,t,o){console.log("share ")}},{key:"shareToFacebook",value:function(e,t){console.log("shareToFacebook")}},{key:"postMessage",value:function(e){console.log("postMessge => "+JSON.stringify(e))}}]),e}()},function(e,t,o){var n,r,i;!function(o,s){r=[],n=s,void 0!==(i="function"==typeof n?n.apply(t,r):n)&&(e.exports=i)}(0,function(){function e(e,t){return-1===e.indexOf(t)?e.length:e.indexOf(t)}function t(t){var o=t.replace(/^v/,"").replace(/\+.*$/,""),n=e(o,"-"),r=o.substring(0,n).split(".");return r.push(o.substring(n+1)),r}function o(e){return isNaN(Number(e))?e:Number(e)}function n(e){if("string"!=typeof e)throw new TypeError("Invalid argument expected string");if(!r.test(e))throw new Error("Invalid argument not valid semver")}var r=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;return function(e,r){[e,r].forEach(n);for(var i=t(e),s=t(r),a=0;a<Math.max(i.length-1,s.length-1);a++){var c=parseInt(i[a]||0,10),u=parseInt(s[a]||0,10);if(c>u)return 1;if(u>c)return-1}var p=i[i.length-1],f=s[s.length-1];if(p&&f){var l=p.split(".").map(o),b=f.split(".").map(o);for(a=0;a<Math.max(l.length,b.length);a++){if(void 0===l[a]||"string"==typeof b[a]&&"number"==typeof l[a])return-1;if(void 0===b[a]||"string"==typeof l[a]&&"number"==typeof b[a])return 1;if(l[a]>b[a])return 1;if(b[a]>l[a])return-1}}else if(p||f)return p?-1:1;return 0}})},function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){if(null===e||"object"!==(void 0===e?"undefined":s(e)))return e;var t=e.constructor();for(var o in e)e.hasOwnProperty(o)&&(t[o]=r(e[o]));return t}var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=(o(0),o(5)),c=o(3),u=o(6),p=o(7),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{debug:!1};n(this,e),this.debug=t.debug,this.defaultTrackers=["leanplum"];try{this.version="1.3.7"}catch(e){this.version="0.0.0"}if("object"===("undefined"==typeof window?"undefined":s(window))&&"object"===s(window.tossAppBridge)&&window.tossAppBridge.version===this.version)return console.log("reuse instance: "+this),window.tossAppBridge;this.debug&&console.log("TossAppBridge - Instantiated with params: "+t),"object"===("undefined"==typeof window?"undefined":s(window))&&("android"===this.osName()?this.bridge=new c(this.getContext()):"ios"===this.osName()?this.bridge=new a(this.getContext()):"object"===s(t.bridge)&&(this.bridge=t.bridge),window.tossAppBridge=this,window.TossAppBridge=this,window.tossWebBridge=new u(this.getContext())),"object"!==s(this.bridge)&&(this.bridge=t.defaultBridge)}return i(e,[{key:"getContext",value:function(){return{debug:this.debug,osName:this.osName(),appVersion:this.appVersion()}}},{key:"setBridge",value:function(e){"android"===e?this.bridge=new c:"ios"===e?this.bridge=new a:console.error("invalid argument")}},{key:"osName",value:function(){return window.navigator.userAgent.toLowerCase().indexOf("android")>=0&&window.navigator.userAgent.toLowerCase().indexOf("tossapp")>=0?"android":window.webkit&&window.webkit.messageHandlers?"ios":""}},{key:"appVersion",value:function(e){var t="0.0.0";try{t=/tossapp\/((\d+).(\d+).(\d+))/g.exec(window.navigator.userAgent.toLowerCase())[1]}catch(e){}return"function"==typeof e&&e(t),t}},{key:"setDefaultEventTrackers",value:function(e){this.defaultTrackers=e}},{key:"trackEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"common",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.defaultTrackers,r={event:e,params:o||{}};if("string"!=typeof t)return void console.error("category should be string - "+t);r.params.category=t,n&&(r._trackers=n),r.params=p.stringifyMembers(r.params),this.debug&&console.log("trackEvent:"+JSON.stringify(r)),this.bridge.trackEvent(r)}},{key:"screenName",value:function(){var e=this.window.document.querySelector('meta[name="screen_name"]');return e&&e.getAttribute("content").split(",")[0]}},{key:"trackScreen",value:function(e){this.debug&&console.log("trackScreen:"+e),this.bridge.trackScreen(e)}},{key:"trackState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.defaultTrackers,n={state:e,info:""};t&&(n.params=t),o&&(n._trackers=o),n.params=p.stringifyMembers(n.params),this.debug&&console.log("trackState:"+JSON.stringify(n)),this.bridge.trackState(n)}},{key:"closeWebView",value:function(){this.debug&&console.log("closeWebView"),this.bridge.closeWebView()}},{key:"share",value:function(e,t,o){this.debug&&console.log("share "),this.bridge.share(e,t,o)}},{key:"shareToFacebook",value:function(e,t){this.debug&&console.log("shareToFacebook"),"function"==typeof t?this.bridge.shareToFacebook(e,tossWebBridge.registerCallback(t)):this.bridge.shareToFacebook(e,"")}},{key:"postMessage",value:function(e){this.debug&&console.log("postMessage "+JSON.stringify(e));var t=r(e),o="requestApi"===e.name;for(var n in e.params)e.params.hasOwnProperty(n)&&(o?"function"==typeof e.params[n]&&function(){var o=e.params[n],r=function(e,t){var n={},r={error:{}};try{n=JSON.parse(e)}catch(t){""===e?n=null:n.message=e}try{r=JSON.parse(t)}catch(e){r.error.reason="invalid response: "+t}return o(n,r)};t.params[n]=tossWebBridge.registerCallback(r)}():"function"==typeof e.params[n]&&(t.params[n]=tossWebBridge.registerCallback(e.params[n])));this.bridge.postMessage(t)}}]),e}();e.exports=f},function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(0),c=o(1),u={};e.exports=function(e){function t(e){n(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return u.closeWebView=c(o.context.appVersion,"1.0.0")>=0,u.trackEvent=c(o.context.appVersion,"2.34.0")>=0,u.trackScreen=c(o.context.appVersion,"2.35.0")>=0,u.trackState=c(o.context.appVersion,"2.35.0")>=0,u.share=c(o.context.appVersion,"3.1.0")>=0,u.shareToFacebook=c(o.context.appVersion,"3.1.0")>=0,u.postMessage=c(o.context.appVersion,"3.1.0")>=0,o}return i(t,e),s(t,[{key:"checkApiSupport",value:function(e){return!!u[e]||(console.warn(e+" is not supported in Android/"+this.context.appVersion),!1)}},{key:"trackEvent",value:function(e){this.checkApiSupport("trackEvent")&&TossApp.sendLog(JSON.stringify(e))}},{key:"trackScreen",value:function(e){this.checkApiSupport("trackScreen")&&TossApp.setScreenName(e)}},{key:"trackState",value:function(e){this.checkApiSupport("trackState")&&TossApp.setState(JSON.stringify(e))}},{key:"closeWebView",value:function(){this.checkApiSupport("closeWebView")&&TossApp.closeWebView()}},{key:"share",value:function(e,t,o){this.checkApiSupport("share")&&TossApp.sendMessage("공유하기",e,t,o)}},{key:"shareToFacebook",value:function(e,t){this.checkApiSupport("shareToFacebook")&&TossApp.shareUrlForFacebook(e,t)}},{key:"postMessage",value:function(e){this.checkApiSupport("postMessage")&&TossNativeBridge.postMessage(JSON.stringify(e))}}]),t}(a)},function(e,t,o){"use strict";var n=o(2),r=o(0),i={};i.debug=!1,i.defaultBridge=new r(i),e.exports=new n(i)},function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(0),c=o(1),u={};e.exports=function(e){function t(e){n(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));try{o.tossapp=window.webkit.messageHandlers}catch(e){o.tossapp={}}return u.closeWebView=c(o.context.appVersion,"2.22.0")>=0,u.trackEvent=c(o.context.appVersion,"2.22.0")>=0,u.trackScreen=c(o.context.appVersion,"2.22.0")>=0,u.trackState=c(o.context.appVersion,"2.22.0")>=0,u.share=c(o.context.appVersion,"2.22.0")>=0,u.shareToFacebook=c(o.context.appVersion,"2.22.0")>=0,u.postMessage=c(o.context.appVersion,"2.22.0")>=0,o}return i(t,e),s(t,[{key:"checkApiSupport",value:function(e){return!!u[e]||(console.warn(e+" is not supported in iOS/"+this.context.appVersion),!1)}},{key:"trackEvent",value:function(e){this.checkApiSupport("trackEvent")&&this.tossapp.tosWebViewLeanplumTrack.postMessage(e)}},{key:"trackScreen",value:function(e){this.checkApiSupport("trackScreen")&&this.tossapp.tosWebViewLeanplumAdvancedTo.postMessage(e)}},{key:"trackState",value:function(e){this.checkApiSupport("trackState")&&this.tossapp.tosWebViewLeanplumAdvancedTo.postMessage(e)}},{key:"closeWebView",value:function(){this.checkApiSupport("closeWebView")&&this.tossapp.tosWebViewAction.postMessage({name:"close"})}},{key:"share",value:function(e,t,o){this.checkApiSupport("share")&&(window.location.href="supertoss://referral/share?message="+encodeURI(t)+"&linkTitle="+encodeURI(e)+"&linkUrl="+encodeURI(o))}},{key:"shareToFacebook",value:function(e,t){this.checkApiSupport("shareToFacebook")&&this.tossapp.tossWebViewAction.postMessage({name:"shareFacebook",url:e,successCallback:t})}},{key:"postMessage",value:function(e){this.checkApiSupport("postMessage")&&this.tossapp.tosWebViewAction.postMessage(e)}}]),t}(a)},function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(){return"_"+Math.random().toString(36).substr(2,9)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=function(){function e(){if(n(this,e),"object"===("undefined"==typeof window?"undefined":i(window))&&"object"===i(window.tossWebBridge))return window.tossWebBridge;window.tossWebBridge=this,this._callbacks=this._callbacks||{}}return s(e,[{key:"registerCallback",value:function(e){var t=r();if("function"==typeof e)this._callbacks[t]=e;else if("string"==typeof e){if("function"!=typeof window[e])throw new Error("callback should be function");this._callbacks[t]=window[e]}return"tossWebBridge._callbacks."+t}}]),e}();e.exports=a},function(e,t,o){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports={stringifyMembers:function(e){var t={};for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];"object"===(void 0===r?"undefined":n(r))?t[o]=JSON.stringify(r):t[o]="number"==typeof r?r.toString():r}return t}}}])});